# N-LINE 機能ドキュメント

## 1. コア機能 (ダッシュボード)

### ステータスモニター
- **説明**: LINEの実行状態をリアルタイムで表示します。
- **インジケーター**: 緑色で「APP RUNNING」、または赤色で「STOPPED」と表示します。
- **仕組み**: バックグラウンドスレッドで `psutil` を使用して2秒ごとにプロセスリストをポーリングします。

### プロセスキラー
- **説明**: LINEアプリケーションとその関連プロセスを強制終了します。
- **ユースケース**: LINEがフリーズしたり、応答しなくなったり、完全な再起動が必要な場合に役立ちます。

### キャッシュクリーナー
- **説明**: 一時キャッシュファイルを安全に削除し、ディスク容量を空け、読み込みの問題を解決します。
- **制約**: LINEが実行されていないときのみ動作します（ファイルロックエラーを防ぐため）。
- **対象**: `%USERPROFILE%\AppData\Local\LINE\Data\Cache` の内容を消去します。

### LINE起動
- **説明**: LINEが現在停止している場合、アプリケーションを起動します。
- **スマート検出**: 標準的なインストールパスにある実行ファイル（`LineLauncher.exe`, `LINE.exe`）を自動的に検索します。

### インストールフォルダを開く
- **説明**: WindowsエクスプローラーでLINEのインストールディレクトリを開き、手動で調査できるようにします。

## 2. バックアップとツール

### ユーザーデータバックアップ
- **説明**: 巨大なキャッシュフォルダを除外して、ユーザーのLINEデータ（チャット、設定など）のバックアップを作成します。
- **保存先**: バックアップは `backups/line_backup_YYYYMMDD_HHMMSS` に保存されます。

## 3. デバッグツール & エンジニアリング
*メインウィンドウ下部の「Open Debug Tools」ボタンからアクセス可能です。*

### プロセス情報 (Process Info)
- **詳細**: システム情報（OS、Pythonバージョン）と、LINEプロセスの詳細メトリクス（PID、メモリ使用量、CPU使用率、コマンドライン引数）を表示します。

### ファイル構造 (File Structure)
- **詳細**: LINEのインストールディレクトリとローカルデータフォルダ内のファイルをリストアップします。ファイル配置を理解するのに役立ちます。

### UIインスペクター (UI Inspector)
- **標準スキャン (Scan Top Windows)**: Win32 APIを使用してLINEプロセスに属するトップレベルウィンドウをリストアップします。クラス名、ウィンドウタイトル、可視性、サイズを表示します。
- **ディープスキャン (Deep Scan UIA)**: Microsoft UI Automationを使用してUIツリー全体をクロールします。内部ボタン、入力フィールド、ペインコントロール、およびそれらの内部ID (`AutomationId`) を特定できます。これは高度なModや自動化スクリプトの開発に不可欠です。

### ウィンドウ操作 (Window Mods - 実験的機能)
- **透明度制御 (Opacity)**: LINEメインウィンドウの透明度をリアルタイムで調整します。
- **常に手前に表示 (Always on Top)**: 「最前面」状態を切り替え、他のすべてのウィンドウの上にLINEを表示し続けます。
- **タイトルハイジャック (Set Title)**: ウィンドウのタイトルテキストを変更します（例：「LINE」から「N-LINE」へ）。
- **ターゲティング**: タイトルが変更されても正しいウィンドウを操作できるように、プロセスID (PID) ターゲティングを使用します。

### 自動化 (Automation - 実験的機能)
- **テキスト入力 (Type Text)**: クリップボードを使用せずに、チャット入力エリア (`AutoSuggestTextArea`) に直接テキストを注入します。
- **エンター送信 (Send Enter)**: プログラムでEnterキーを押す操作をシミュレートしてメッセージを送信します。
