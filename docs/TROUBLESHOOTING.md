# トラブルシューティング

N-LINEを使用する際によくある問題と解決方法をまとめています。

## 目次

- [インストール関連](#インストール関連)
- [実行時エラー](#実行時エラー)
- [機能が動作しない](#機能が動作しない)
- [パフォーマンス問題](#パフォーマンス問題)

## インストール関連

### Pythonが見つからない

**問題:** `python`コマンドが認識されない

**解決方法:**
1. Pythonがインストールされているか確認
2. 環境変数`PATH`にPythonが追加されているか確認
3. Python 3.8以上がインストールされているか確認

### 依存関係のインストールに失敗する

**問題:** `pip install`や`rye sync`が失敗する

**解決方法:**
1. インターネット接続を確認
2. 管理者権限で実行を試す
3. 仮想環境を使用しているか確認
4. 古いキャッシュをクリア: `pip cache purge`

### pywin32のインストールエラー

**問題:** `pywin32`のインストールに失敗する

**解決方法:**
1. Visual C++ Redistributableがインストールされているか確認
2. 管理者権限で実行: `pip install pywin32`
3. 手動でインストール後、`python Scripts/pywin32_postinstall.py -install`を実行

## 実行時エラー

### LINEプロセスが見つからない

**問題:** LINEプロセスが見つからないというエラー

**解決方法:**
1. LINEが実行中か確認
2. プロセス名が`LINE.exe`であることを確認
3. 管理者権限で実行を試す
4. タスクマネージャーでLINEプロセスを確認

### モジュールが見つからない

**問題:** `ModuleNotFoundError`が発生する

**解決方法:**
1. 依存関係がインストールされているか確認: `pip list`
2. 仮想環境がアクティブか確認
3. 依存関係を再インストール: `pip install -r requirements.txt`

### ウィンドウが見つからない

**問題:** ウィンドウ操作機能でウィンドウが見つからない

**解決方法:**
1. LINEが実行中か確認
2. LINEウィンドウが表示されているか確認
3. ウィンドウが最小化されていないか確認
4. 別のプロセスIDで試す

## 機能が動作しない

### UI Automationが動作しない

**問題:** UI Inspectorや自動化機能が動作しない

**解決方法:**
1. LINEが実行中か確認
2. チャットウィンドウが開いているか確認
3. 管理者権限で実行を試す
4. COMの初期化が必要な場合がある（コード内で`UIAutomationInitializerInThread`を使用）

### ホットキーが動作しない

**問題:** Ctrl+Shiftでポイントインスペクトが動作しない

**解決方法:**
1. 管理者権限で実行を試す（Windowsではホットキーに管理者権限が必要な場合がある）
2. 他のアプリケーションが同じホットキーを使用していないか確認
3. キーボードライブラリが正常に動作しているか確認

### QSSが適用されない

**問題:** QSSファイルを適用してもスタイルが変更されない

**解決方法:**
1. LINEが再起動されているか確認
2. QSSファイルのパスが正しいか確認
3. QSSファイルの構文が正しいか確認
4. クラス名が正しいか確認（UI Inspectorで確認）

### キャッシュクリアが失敗する

**問題:** キャッシュクリアが失敗する

**解決方法:**
1. LINEが完全に終了しているか確認
2. 管理者権限で実行を試す
3. 手動でキャッシュフォルダを削除: `%LOCALAPPDATA%\LINE\Cache`

## パフォーマンス問題

### アプリケーションが重い

**問題:** アプリケーションの動作が遅い

**解決方法:**
1. システムリソースを確認（CPU、メモリ）
2. 他の重いアプリケーションを終了
3. デバッグツールのタブを閉じる（メモリ使用量を減らす）

### UI Inspectorが遅い

**問題:** UI Inspectorのスキャンに時間がかかる

**解決方法:**
1. 深いスキャンは時間がかかるため、通常のスキャンを使用
2. スキャン中は他の操作を避ける
3. 必要に応じてスキャン範囲を制限

## その他の問題

### ログが表示されない

**問題:** ログテキストボックスに何も表示されない

**解決方法:**
1. ログテキストボックスが有効になっているか確認
2. アプリケーションを再起動
3. エラーメッセージを確認

### デバッグウィンドウが開かない

**問題:** デバッグツールボタンをクリックしてもウィンドウが開かない

**解決方法:**
1. 既に開いているウィンドウがないか確認
2. アプリケーションを再起動
3. エラーログを確認

## サポート

上記の解決方法で問題が解決しない場合は、以下の方法でサポートを求めてください:

1. [GitHub Issues](https://github.com/nezumi0627/n-line/issues)で問題を報告
2. エラーメッセージとログを添付
3. 実行環境の情報（OS、Pythonバージョンなど）を記載

